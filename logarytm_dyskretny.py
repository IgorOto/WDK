import gmpy2
from gmpy2 import f_mod
from gmpy2 import mul
from gmpy2 import mpz
from gmpy2 import powmod


p = mpz(13407807929942597099574024998205846127479365820592393377723561443721764030073546976801874298166903427690031858186486050853753882811946569946433649006084171)
h = mpz(4476678147226155115558365457750475595861521772603596936757528326067178243549776543712192144627870184928567432208656624794079113374237487568153440925199271)
g = mpz(26790476600736210439911326117339978371955050182095051707060863109260114006743503487596200818701323671541681934177621901008556022090467034705794892743945893)


zb ={}

for i in range(2**20):

    a1 = f_mod(h, p)
    a2 = powmod(g, (-i), p)
    b = mul(a1,a2)
    c = f_mod(b,p)
    zb[c]=i

for i in range(len(zb)):

    d = i*(2**20)
    e = powmod(g,d,p)
    if zb.has_key(e) == True:
        break

x = i*(2**20)+ zb[e]
print "x = %s" %x
